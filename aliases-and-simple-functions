# zfs list replacement; importantly show canmount and mounted.
# zfs list options like -t or -r can be added afterards

alias zls='zfs list -o name,size,available,referenced,canmount,mounted,mountpoint'

# importing a pool to an alt-root to chroot into can stuff-up your /etc/zfs/zfs-list.cache
# as if it updates; the alt-root will prefix the mountpoint. Therefore use mount and unmount like so

alias zm='mount -o zfsutil -t zfs'
alias zu='umount -lf -t zfs'

# function to list datasets have either canmount=on or mounted=yes to quickly check for correct mounting
# $@ can include -t and -r  options also
zlsm() {
    zfs list -o name,size,available,referenced,canmount,mounted,mountpoint "$@" | egrep -e ' on ' -e ' yes '
}

# function to list datasets NOT mounted that either also have canmount=noauto or canmount=off
zlsn() {
    zfs list -o name,size,available,referenced,canmount,mounted,mountpoint "$@" | egrep -e ' noauto[ ]+no ' -e ' off[ ]+no '
}

# function to list all distros with active zsys and the zsys custom proerties
# note I build zsys into arch and debian and pve distros which share my bpool & rpool
zlsz() {
    zfs get -r -o name,property,value -t filesystem all "$@" | egrep -e ' com\.ubuntu\.zsys\:[^ ]+'
}
